# -*- coding: utf-8 -*-
import tushare as ts
import time
import math
from operator import itemgetter, attrgetter
import numpy as np

#定义配置
# 大宗买入交易与大宗卖出交易的倍数
block_proportion = 2
# 设置大宗交易阀值，10000只
# block_threshold = 3000
# 设置大宗交易金额阀值，100万元
block_price = 50000000
date_now = time.strftime('%Y-%m-%d', time.localtime(time.time()))
def check_block_transaction(stock_code, stock_name, stock_price):
    buy_count = 0
    sell_count = 0
    print(stock_code, stock_name, stock_price, end="")
    block_threshold = math.ceil(block_price / (stock_price * 100))
    df = ts.get_sina_dd(stock_code, date='2019-03-07', vol=block_threshold)
    if df is None:
       return False, 0
    for i in range(0,len(df)):
        if(df['type'][i] == '卖盘'):
            sell_count = sell_count + df['volume'][i]
        elif(df['type'][i] == '买盘'):
            buy_count = buy_count + df['volume'][i]
    mess = stock_name + '买盘：' + str(buy_count) + '卖盘：' + str(sell_count)
    print(mess)
    if(buy_count > block_proportion * sell_count):
        if sell_count == 0:
            return True, buy_count
        return True, buy_count / sell_count
    return False, 0

#获取当天大宗交易模型
def get_today_block_transaction_stock():

    results = ts.get_today_all()
    date_list = []
    up_list = []
    down_list = []

    print('--------------------')
    j = 0
    up = 0
    down = 0
    for i in range(0,len(results)):
        # print(results['code'][i], results['name'][i], results['trade'][i])

        if results['amount'][i] < block_price:
            continue
        check_value, than = check_block_transaction(results['code'][i], results['name'][i], results['trade'][i])
        print(check_value, than)
        if check_value:
                date_list.append([results['code'][i], results['name'][i], than])
                if ('ST' in results['name'][i]):
                    continue
                if(results['changepercent'][i] > 0 and results['changepercent'][i] < 9.9):
                    up = up + 1
                    up_list.append([results['code'][i], results['name'][i], than])
                elif(results['changepercent'][i] < 0):
                    down = down + 1
                    down_list.append([results['code'][i], results['name'][i], than])
                j = j + 1
        print('已处理完' + str(i) + '支股票')
    date_list_neat = sorted(date_list, key=itemgetter(2), reverse=True)
    # print(date_list_neat)
    print('Success！目前共' + str(j) + "只股票符合大宗交易模型")
    print('-----------------')
    print('上涨股票' + str(up) + "只")
    print(up_list)
    print('下跌股票' + str(down) + "只")
    print(down_list)

    # 1000万
    # up_list = [['603799', '华友钴业', 2.935975735142916], ['603501', '韦尔股份', 306100], ['603383', '顶点软件', 2.675010789814415], ['603323', '吴江银行', 3.6836425489545306], ['603266', '天龙股份', 704800], ['603239', '浙江仙通', 1160000], ['603105', '芯能科技', 663100], ['603006', '联明股份', 2033400], ['601992', '金隅集团', 5033700], ['601990', '南京证券', 4.212418946988169], ['601949', '中国出版', 3432906], ['601901', '方正证券', 2.193954295632051], ['601899', '紫金矿业', 3.309527951908366], ['601890', '亚星锚链', 2.9196452642781128], ['601881', '中国银河', 2.229072606411467], ['601860', '紫金银行', 3.9077227515003985], ['601788', '光大证券', 2.542052445231246], ['601666', '平煤股份', 3217402], ['601618', '中国中冶', 2.0425402341056254], ['601608', '中信重工', 2.099586504083243], ['601606', '长城军工', 2.846105724116359], ['601598', '中国外运', 2.9890868234183623], ['601577', '长沙银行', 2581400], ['601555', '东吴证券', 3151434], ['601377', '兴业证券', 5.677908247494594], ['601298', '青岛港', 4.080371340281778], ['601258', '庞大集团', 4.862019216104926], ['601233', '桐昆股份', 1062700], ['601229', '上海银行', 1545928], ['601211', '国泰君安', 4.659983041266252], ['601198', '东兴证券', 3713021], ['601162', '天风证券', 4.00405623370782], ['601138', '工业富联', 2.8945508695652173], ['601068', '中铝国际', 2.4114596045887233], ['600999', '招商证券', 4194500], ['600975', '新五丰', 1621000], ['600970', '中材国际', 2.755079006772009], ['600959', '江苏有线', 1869100], ['600958', '东方证券', 6.208668698784688], ['600926', '杭州银行', 2007676], ['600919', '江苏银行', 2310881], ['600903', '贵州燃气', 1604701], ['600901', '江苏租赁', 2125800], ['600895', '张江高科', 2.6395567104990922], ['600869', '智慧能源', 2635200], ['600868', '梅雁吉祥', 2.7668042987364143], ['600864', '哈投股份', 6967039], ['600848', '上海临港', 548800], ['600845', '宝信软件', 838250], ['600839', '四川长虹', 2.218532660857783], ['600795', '国电电力', 7230180], ['600794', '保税科技', 8873500], ['600770', '综艺股份', 4404400], ['600755', '厦门国贸', 2.4571919144618746], ['600751', '海航科技', 2662700], ['600740', '山西焦化', 4.268052748098951], ['600718', '东软集团', 2.8584230816139313], ['600711', '盛屯矿业', 2.74092789386574], ['600682', '南京新百', 1279698], ['600649', '城投控股', 10.984626842751842], ['600621', '华鑫股份', 3.512613949544202], ['600614', '鹏起科技', 2636266], ['600613', '神奇制药', 5.101598954768867], ['600601', '方正科技', 4972800], ['600596', '新安股份', 1224983], ['600549', '厦门钨业', 925570], ['600536', '中国软件', 2.5629615403729638], ['600503', '华丽家族', 2.8699672140257286], ['600497', '驰宏锌锗', 3213726], ['600489', '中金黄金', 6498188], ['600460', '士兰微', 2.2121650591860367], ['600425', '青松建化', 2.625241641763168], ['600422', '昆药集团', 3.4833229901269394], ['600410', '华胜天成', 2185932], ['600392', '盛和资源', 3.302113793098322], ['600362', '江西铜业', 2083000], ['600282', '南钢股份', 3625167], ['600271', '航天信息', 2.1600674669236835], ['600260', '凯乐科技', 2450575], ['600256', '广汇能源', 3.2387670121527203], ['600240', '华业资本', 5449800], ['600226', '瀚叶股份', 3459110], ['600221', '海航控股', 3.193464012062652], ['600218', '全柴动力', 2.785431375925607], ['600212', '江泉实业', 4125700], ['600210', '紫江企业', 2.2772773019781476], ['600175', '美都能源', 4179700], ['600172', '黄河旋风', 5319140], ['600157', '永泰能源', 2.8704597615841716], ['600109', '国金证券', 2.206203241895262], ['600100', '同方股份', 3.188427929074404], ['600064', '南京高科', 2.6115054165110196], ['600025', '华能水电', 2893600], ['600020', '中原高速', 4172900], ['300759', '康龙化成', 221500], ['300691', '联合光电', 660258], ['300660', '江苏雷利', 426066], ['300618', '寒锐钴业', 84840], ['300545', '联得装备', 458700], ['300539', '横河模具', 6.678892908558067], ['300495', '美尚生态', 520000], ['300481', '濮阳惠成', 300800], ['300379', '东方通', 2.902622767857143], ['300356', '光一科技', 2210600], ['300343', '联创互联', 1475694], ['300311', '任子行', 1653258], ['300309', '吉艾科技', 2.463133217816736], ['300297', '蓝盾股份', 2.496566926555249], ['300270', '中威电子', 2699097], ['300269', '联建光电', 2321820], ['300113', '顺网科技', 2.000394206361057], ['300090', '盛运环保', 8488900], ['300078', '思创医惠', 1472300], ['300077', '国民技术', 5.672762271414822], ['300048', '合康新能', 6418004], ['002947', '恒铭达', 92100], ['002946', '新乳业', 711500], ['002945', '华林证券', 2.240121398722965], ['002939', '长城证券', 2.2618642504611395], ['002926', '华西证券', 2.6019677442862577], ['002797', '第一创业', 3.567718862978317], ['002771', '真视通', 532800], ['002716', '金贵银业', 10.02427564604542], ['002689', '远大智能', 3.7237528886978017], ['002673', '西部证券', 2.9139247088186355], ['002668', '奥马电器', 2.841132193962581], ['002642', '荣之联', 1150700], ['002610', '爱康科技', 15276700], ['002601', '龙蟒佰利', 1418681], ['002587', '奥拓电子', 4.288293413173653], ['002512', '达华智能', 1780901], ['002500', '山西证券', 3.5817375886524823], ['002491', '通鼎互联', 771000], ['002477', '雏鹰农牧', 3144800], ['002413', '雷科防务', 895710], ['002385', '大北农', 9.808679888300606], ['002373', '千方科技', 3.3214819017360715], ['002369', '卓翼科技', 3.180139084440047], ['002367', '康力电梯', 2.0545006079555326], ['002340', '格林美', 9.099963431508204], ['002292', '奥飞娱乐', 4.148144177126918], ['002238', '天威视讯', 1044200], ['002226', '江南化工', 3.501945525291829], ['002197', '证通电子', 586000], ['002191', '劲嘉股份', 1901600], ['002189', '利达光电', 276300], ['002157', '正邦科技', 3.219912475394059], ['002143', '印纪传媒', 2.5081406756407083], ['002131', '利欧股份', 3.135265259474508], ['002124', '天邦股份', 4.951031530307149], ['002118', '紫鑫药业', 2.347513812154696], ['002095', '生 意 宝', 4.009941529190656], ['002076', '雪 莱 特', 2.818074988568816], ['002038', '双鹭药业', 202400], ['002031', '巨轮智能', 6646250], ['000988', '华工科技', 325603], ['000983', '西山煤电', 2046400], ['000960', '锡业股份', 2.5059741526456962], ['000933', '神火股份', 3128441], ['000862', '银星能源', 2.330217774864183], ['000806', '银河生物', 1056700], ['000795', '英洛华', 5277955], ['000793', '华闻传媒', 1121100], ['000783', '长江证券', 6.713959183673469], ['000776', '广发证券', 2.707672627715398], ['000728', '国元证券', 3.1315074471112796], ['000712', '锦龙股份', 1223000], ['000670', '盈方微', 4794900], ['000629', '攀钢钒钛', 3.365099324392457], ['000587', '金洲慈航', 1971900], ['000166', '申万宏源', 4.1970909317079235], ['000158', '常山北明', 2080384], ['000068', '华控赛格', 1353100], ['000025', '特 力Ａ', 18.67978620689655], ['000009', '中国宝安', 8.13805078322385]]
    # 500万
    # up_list = [['603993', '洛阳钼业', 2.60059482448784], ['603799', '华友钴业', 991866], ['603629', '利通电子', 5.589204395604396], ['603000', '人民网', 2.5509468722559694], ['601990', '南京证券', 6.42770686919066], ['601899', '紫金矿业', 3.246697631518266], ['601890', '亚星锚链', 1465620], ['601881', '中国银河', 7.487652664576802], ['601860', '紫金银行', 10.707446808510639], ['601700', '风范股份', 4.842247740963855], ['601688', '华泰证券', 2.2331899302146874], ['601618', '中国中冶', 4.666130560900657], ['601608', '中信重工', 8.55864217078422], ['601598', '中国外运', 11.784832012702655], ['601377', '兴业证券', 10128770], ['601258', '庞大集团', 5.953750998346924], ['601212', '白银有色', 2.249493993105771], ['601211', '国泰君安', 3296010], ['601198', '东兴证券', 2318986], ['601162', '天风证券', 15.228193254527708], ['601138', '工业富联', 3.120876974968933], ['601099', '太平洋', 2.531320722696752], ['601009', '南京银行', 2.2104277848395144], ['600958', '东方证券', 5993585], ['600909', '华安证券', 2.241408477023698], ['600903', '贵州燃气', 1217501], ['600895', '张江高科', 15.839521361698427], ['600868', '梅雁吉祥', 9.563433376617706], ['600839', '四川长虹', 3.2390759719741724], ['600837', '海通证券', 2.504405881382496], ['600649', '城投控股', 3258295], ['600635', '大众公用', 2.2037988935713133], ['600613', '神奇制药', 2650000], ['600588', '用友网络', 4.495267857142857], ['600536', '中国软件', 5.918221516474792], ['600503', '华丽家族', 6.147980711271851], ['600460', '士兰微', 9.862844246509388], ['600425', '青松建化', 4.298620209418683], ['600422', '昆药集团', 3189414], ['600392', '盛和资源', 2.3841003540760206], ['600271', '航天信息', 3.973872387238724], ['600260', '凯乐科技', 989355], ['600221', '海航控股', 10377800], ['600218', '全柴动力', 2278900], ['600157', '永泰能源', 3.611799591865731], ['600109', '国金证券', 2775000], ['300539', '横河模具', 6629596], ['300379', '东方通', 1832100], ['300297', '蓝盾股份', 2.6737491432488008], ['300182', '捷成股份', 2.251536206792257], ['300113', '顺网科技', 2.4952369728091592], ['002948', '青岛银行', 2248516], ['002939', '长城证券', 4678847], ['002926', '华西证券', 2964200], ['002797', '第一创业', 3.8262715346187965], ['002771', '真视通', 532800], ['002689', '远大智能', 4450627], ['002673', '西部证券', 879409], ['002668', '奥马电器', 2.775131360916264], ['002565', '顺灏股份', 3.639656915167727], ['002450', 'ST康得新', 2.804668939863608], ['002426', '胜利精密', 13955200], ['002405', '四维图新', 611800], ['002385', '大北农', 7144900], ['002369', '卓翼科技', 2788987], ['002359', '北讯集团', 3.2699463531560324], ['002340', '格林美', 4715443], ['002292', '奥飞娱乐', 1834600], ['002226', '江南化工', 4850700], ['002157', '正邦科技', 2.824687787587877], ['002131', '利欧股份', 12.484819984968013], ['002124', '天邦股份', 1320150], ['002095', '生 意 宝', 2.9848102034618886], ['002075', '沙钢股份', 2.2439730789142813], ['002031', '巨轮智能', 4804350], ['000862', '银星能源', 4.062486132543688], ['000839', '中信国安', 2.0626438225525336], ['000776', '广发证券', 2.2484644343174165], ['000670', '盈方微', 2521100], ['000630', '铜陵有色', 7845800], ['000413', '东旭光电', 2.6787054214697408], ['000166', '申万宏源', 9939500], ['000050', '深天马Ａ', 3.4142100878725175], ['000025', '特 力Ａ', 2550469], ['000009', '中国宝安', 3342500]]
    # 100万
    # up_list =[['603999', '读者传媒', 604400], ['603988', '中电电机', 2.1092397355206653], ['603979', '金诚信', 249200], ['603970', '中农立华', 265260], ['603969', '银龙股份', 4.257439894625617], ['603963', '大理药业', 7.051783355350066], ['603958', '哈森股份', 1486600], ['603936', '博敏电子', 203665], ['603933', '睿能科技', 175200], ['603901', '永创智能', 2.034188034188034], ['603900', '莱绅通灵', 295769], ['603895', '天永智能', 4.234647302904564], ['603883', '老百姓', 8.409162011173184], ['603877', '太平鸟', 2.3518400037913794], ['603871', '嘉友国际', 76400], ['603859', '能科股份', 234985], ['603856', '东宏股份', 4.579175946547884], ['603843', '正平股份', 2.1619339984650807], ['603838', '四通股份', 7.396467619848612], ['603818', '曲美家居', 456500], ['603810', '丰山集团', 2.1377551020408165], ['603801', '志邦家居', 2.043659043659044], ['603800', '道森股份', 176500], ['603790', '雅运股份', 5.29464], ['603766', '隆鑫通用', 3.2915346571749717], ['603739', '蔚蓝生物', 2.0284853234945475], ['603729', '龙韵股份', 2.571320474777448], ['603713', '密尔克卫', 3.6333333333333333], ['603689', '皖天然气', 180100], ['603683', '晶华新材', 2.5305389221556887], ['603680', '今创集团', 129200], ['603676', '卫信康', 395700], ['603667', '五洲新春', 199940], ['603663', '三祥新材', 4.285483870967742], ['603659', '璞泰来', 2.086079734219269], ['603657', '春光科技', 2.6557377049180326], ['603656', '泰禾光电', 4.284460431654677], ['603650', '彤程新材', 2.020070245860512], ['603648', '畅联股份', 5.357851239669421], ['603618', '杭电股份', 660900], ['603616', '韩建河山', 2.4166666666666665], ['603615', '茶花股份', 310000], ['603612', '索通发展', 7.761075949367089], ['603587', '地素时尚', 2.853862679508622], ['603557', '起步股份', 5.128333333333333], ['603555', '贵人鸟', 3.0293967466627763], ['603533', '掌阅科技', 3.651923076923077], ['603517', '绝味食品', 2.8173228346456693], ['603508', '思维列控', 51200], ['603501', '韦尔股份', 2.396290352641605], ['603500', '祥和实业', 3.235576923076923], ['603499', '翔港科技', 3.5390206489675515], ['603477', '振静股份', 767000], ['603458', '勘设股份', 3.413639733135656], ['603456', '九洲药业', 3.3016123932975026], ['603444', '吉比特', 3.2162328767123287], ['603399', '吉翔股份', 8.701829115509897], ['603398', '邦宝益智', 2.2025], ['603389', '亚振家居', 419920], ['603386', '广东骏亚', 3.186991869918699], ['603377', '东方时尚', 2.434312210200927], ['603367', '辰欣药业', 4.325], ['603363', '傲农生物', 2.8266414267211317], ['603357', '设计总院', 386200], ['603348', '文灿股份', 7.75641404805915], ['603336', '宏辉果蔬', 2.248221906116643], ['603332', '苏州龙杰', 2.67330866382431], ['603329', '上海雅仕', 125200], ['603318', '派思股份', 550300], ['603309', '维力医疗', 2.0267094017094016], ['603298', '杭叉集团', 251000], ['603297', '永新光学', 3.0420650095602295], ['603289', '泰瑞机器', 5.058295964125561], ['603283', '赛腾股份', 123800], ['603278', '大业股份', 262800], ['603266', '天龙股份', 2.616826497165131], ['603239', '浙江仙通', 3.433293508295618], ['603222', '济民制药', 28.386], ['603189', '网达软件', 2.1042228212039533], ['603159', '上海亚虹', 234700], ['603126', '中材节能', 889400], ['603121', '华培动力', 2.206133899740942], ['603116', '红蜻蜓', 426961], ['603106', '恒银金融', 4.696515004840271], ['603103', '横店影视', 3.456545601291364], ['603078', '江化微', 3.489311163895487], ['603077', '和邦生物', 2.1577883431785225], ['603050', '科林电气', 6.208715277777777], ['603040', '新坐标', 148795], ['603030', '全筑股份', 2.0160703456640388], ['603016', '新宏泰', 150000], ['603010', '万盛股份', 2.21882951653944], ['603009', '北特科技', 322300], ['603006', '联明股份', 2.7831283360408445], ['601991', '大唐发电', 18.160049751243783], ['601969', '海南矿业', 765900], ['601968', '宝钢包装', 2.767300194931774], ['601952', '苏垦农发', 2.731308392845443], ['601949', '中国出版', 7015026], ['601919', '中远海控', 3.6306797134370083], ['601900', '南方传媒', 227500], ['601898', '中煤能源', 3.5183210697313143], ['601880', '大连港', 3.5771855764509812], ['601872', '招商轮船', 1095500], ['601858', '中国科传', 674183], ['601666', '平煤股份', 3.602432475183802], ['601588', '北辰实业', 2.2606698576347344], ['601558', 'ST锐电', 2.0747790180011614], ['601555', '东吴证券', 2.060701321950269], ['601518', '吉林高速', 3.2038138291098943], ['601515', '东风股份', 2.0657219171983976], ['601366', '利群股份', 5.343110127282789], ['601360', '三六零', 2.472500123858438], ['601330', '绿色动力', 14.452135493372607], ['601326', '秦港股份', 3.112520325203252], ['601233', '桐昆股份', 2.882086565270739], ['601200', '上海环境', 226400], ['601188', '龙江交通', 1146595], ['601127', '小康股份', 496958], ['601116', '三江购物', 3.908686297841251], ['601101', '昊华能源', 2.7327497587251983], ['601086', '国芳集团', 959570], ['601069', '西部黄金', 2.7265993265993265], ['601020', '华钰矿业', 5.158968850698174], ['601018', '宁波港', 3.253204008807228], ['601016', '节能风电', 2.115409649269079], ['601015', '陕西黑猫', 969620], ['601011', '宝泰隆', 2.184165545332218], ['600988', '赤峰黄金', 6.342693922499828], ['600966', '博汇纸业', 8.67028092656481], ['600939', '重庆建工', 488100], ['600929', '湖南盐业', 2.5204469273743015], ['600917', '重庆燃气', 2.959798994974874], ['600898', '国美通讯', 452000], ['600891', '秋林集团', 3.668716054746904], ['600890', '中房股份', 591900], ['600871', '*ST油服', 9.102129337539433], ['600869', '智慧能源', 3.1094087774459935], ['600855', '航天长峰', 2.278569074821835], ['600850', '华东电脑', 3.6215944540727905], ['600838', '上海九百', 424542], ['600836', '界龙实业', 677500], ['600830', '香溢融通', 13.962411737347258], ['600827', '百联股份', 5.804289318755257], ['600826', '兰生股份', 2.967710371819961], ['600800', '天津磁卡', 2.894163361661945], ['600798', '宁波海运', 2.6891640866873066], ['600795', '国电电力', 2.155339394579489], ['600794', '保税科技', 4.6239146505738455], ['600792', '云煤能源', 4.994469408918079], ['600773', '西藏城投', 2.8702531645569622], ['600766', '园城黄金', 2.3009992467814255], ['600765', '中航重机', 2.9531998582160375], ['600757', '长江传媒', 7.679], ['600743', '华远地产', 3.621357903790945], ['600740', '山西焦化', 2.1078034154198138], ['600726', '华电能源', 3107685], ['600722', '金牛化工', 4.923615874571289], ['600715', '文投控股', 6.051069729509311], ['600708', '光明地产', 2.3707439046634646], ['600697', '欧亚集团', 284735], ['600694', '大商股份', 4.919339465809598], ['600692', '亚通股份', 5.233812949640288], ['600689', '上海三毛', 5.592920353982301], ['600687', '刚泰控股', 2.202543129369011], ['600653', '申华控股', 2.0032623794325546], ['600652', '游久游戏', 2.254537592143041], ['600649', '城投控股', 2.743279188307124], ['600638', '新黄浦', 325700], ['600626', '申达股份', 2.127841845140033], ['600619', '海立股份', 213500], ['600615', '丰华股份', 821800], ['600613', '神奇制药', 3.7979839047514057], ['600603', '广汇物流', 3.4932519920318725], ['600601', '方正科技', 2.479629509411114], ['600592', '龙溪股份', 2.5750991288675276], ['600590', '泰豪科技', 2.2680785758133823], ['600589', '广东榕泰', 4.840106571936057], ['600571', '信雅达', 2.8082150394313006], ['600562', '国睿科技', 2.1581173192696155], ['600550', '保变电气', 2.541469703480877], ['600548', '深高速', 229811], ['600546', '山煤国际', 5.565237427720343], ['600545', '卓郎智能', 2.535740148379764], ['600533', '栖霞建设', 3.8022418434839533], ['600532', '宏达矿业', 2.0562659846547313], ['600531', '豫光金铅', 3.55328125], ['600526', '菲达环保', 2.1976458102175696], ['600508', '上海能源', 2.473093401885176], ['600501', '航天晨光', 2.140017667844523], ['600493', '凤竹纺织', 2.8187290969899665], ['600486', '扬农化工', 2.7964860907759883], ['600479', '千金药业', 512900], ['600476', '湘邮科技', 645200], ['600475', '华光股份', 2.0230502227976395], ['600470', '六国化工', 4.614856706152082], ['600468', '百利电气', 3.5548932595924687], ['600467', '好当家', 3.152], ['600419', '天润乳业', 5.0333722474940625], ['600396', '金山股份', 5.406655248348422], ['600395', '盘江股份', 4.866982780134764], ['600387', '海越能源', 3.0988971193415638], ['600372', '中航电子', 2.89131875576251], ['600368', '五洲交通', 1576518], ['600356', '恒丰纸业', 4.346104725415071], ['600354', '敦煌种业', 5.178030453492221], ['600351', '亚宝药业', 2.89126213592233], ['600333', '长春燃气', 2.0107338154877406], ['600329', '中新药业', 6.203687405159332], ['600328', '兰太实业', 2.7799433724832214], ['600321', '*ST正源', 3.3490420088063786], ['600317', '营口港', 3.7253047743714682], ['600313', '农发种业', 3.3580149435476394], ['600310', '桂东电力', 2.321169500257599], ['600300', '维维股份', 2.4902370036077364], ['600297', '广汇汽车', 3.869301454385192], ['600289', '*ST信通', 902000], ['600287', '江苏舜天', 3.3893996755002704], ['600280', '中央商场', 2.1408441600413677], ['600269', '赣粤高速', 4.141701514775267], ['600266', '北京城建', 2.289715271697669], ['600249', '两面针', 5.546189034645139], ['600220', '江苏阳光', 2.99039837307778], ['600212', '江泉实业', 2.0080374313580145], ['600200', '江苏吴中', 3.9614046955829685], ['600186', '莲花健康', 2.42321265189421], ['600179', '安通控股', 2.788051126531419], ['600155', '华创阳安', 3.7758067189392492], ['600146', '商赢环球', 2.5869379330118534], ['600139', '西部资源', 3.0494399035970186], ['600121', '郑州煤电', 2.1754502891765353], ['600119', '长江投资', 7.960857142857143], ['600117', '西宁特钢', 2.427654813529922], ['600095', '哈高科', 3.2217256789274664], ['600090', '同济堂', 3.317954160550977], ['600084', '中葡股份', 4.04508154149787], ['600080', '金花股份', 7.815262567324955], ['600075', '新疆天业', 4.525842696629214], ['600063', '皖维高新', 2.7798071090622347], ['600054', '黄山旅游', 4.663453815261044], ['600025', '华能水电', 3.5381035638306164], ['300756', '中山金马', 7.06280193236715], ['300753', '爱朋医疗', 3.2280621455997154], ['300743', '天地数码', 55600], ['300738', '奥飞数据', 61300], ['300732', '设研院', 2.23], ['300727', '润禾材料', 57920], ['300715', '凯伦股份', 100840], ['300705', '九典制药', 5.834912043301759], ['300703', '创源文化', 76300], ['300698', '万马科技', 54400], ['300695', '兆丰股份', 20400], ['300694', '蠡湖股份', 2.14104733726845], ['300668', '杰恩设计', 112300], ['300663', '科蓝软件', 102899], ['300653', '正海生物', 3.974169741697417], ['300651', '金陵体育', 5.112385321100917], ['300649', '杭州园林', 54700], ['300645', '正元智慧', 2.8986384266263236], ['300644', '南京聚隆', 35500], ['300624', '万兴科技', 2.8088796185935636], ['300613', '富瀚微', 3.8468468468468466], ['300582', '英飞特', 4.730184723221255], ['300578', '会畅通讯', 4.654530380196612], ['300561', '汇金科技', 2.2566498921639107], ['300551', '古鳌科技', 171900], ['300542', '新晨科技', 60887], ['300539', '横河模具', 4.4881029498076215], ['300522', '世名科技', 174035], ['300513', '恒实科技', 2.788583509513742], ['300508', '维宏股份', 119800], ['300505', '川金诺', 154700], ['300503', '昊志机电', 180300], ['300476', '胜宏科技', 2.32012537787133], ['300464', '星徽精密', 258900], ['300462', '华铭智能', 204400], ['300453', '三鑫医疗', 3.4064598162315876], ['300444', '双杰电气', 2.2596914285714287], ['300430', '诚益通', 230800], ['300426', '唐德影视', 2.6992724333063864], ['300414', '中光防雷', 88900], ['300411', '金盾股份', 772200], ['300407', '凯发电气', 120000], ['300381', '溢多利', 249600], ['300375', '鹏翎股份', 1012500], ['300369', '绿盟科技', 2.5944380026182907], ['300359', '全通教育', 2.0082829731023435], ['300356', '光一科技', 2.1217411809236797], ['300344', '太空智造', 996400], ['300340', '科恒股份', 2.9462265727587442], ['300331', '苏大维格', 466600], ['300318', '博晖创新', 482198], ['300307', '慈星股份', 2.284647779479326], ['300301', '长方集团', 708600], ['300289', '利德曼', 318797], ['300284', '苏交科', 4.743898787243599], ['300279', '和晶科技', 2.1243632749409866], ['300267', '尔康制药', 6.638091688408498], ['300255', '常山药业', 5.905802773497689], ['300237', '美晨生态', 3.4182755116852954], ['300231', '银信科技', 7.772716920974721], ['300209', '天泽信息', 70400], ['300194', '福安药业', 601000], ['300180', '华峰超纤', 2.416585589228793], ['300175', '朗源股份', 2.300263374485597], ['300153', '科泰电源', 3.2333623298033283], ['300138', '晨光生物', 200500], ['300127', '银河磁体', 82100], ['300116', '坚瑞沃能', 2.422773996498012], ['300114', '中航电测', 5.281160698119297], ['300108', '吉药控股', 4.4745538664904165], ['300087', '荃银高科', 408700], ['300079', '数码科技', 7.042833432128038], ['300068', '南都电源', 226800], ['300067', '安诺其', 425392], ['300063', '天龙集团', 2.0825997675319643], ['300052', '中青宝', 4.924868350349275], ['300051', '三五互联', 4.372207497160167], ['300043', '星辉娱乐', 2.452448748617635], ['300039', '上海凯宝', 2.1813143469730374], ['300031', '宝通科技', 76600], ['300023', '宝德股份', 657794], ['300022', '吉峰科技', 300000], ['300020', '银江股份', 2.7866327356757865], ['002942', '新农股份', 2.5785982744785128], ['002932', '明德生物', 29120], ['002927', '泰永长征', 2.162766945218199], ['002922', '伊戈尔', 100304], ['002917', '金奥博', 200983], ['002905', '金逸影视', 72800], ['002902', '铭普光磁', 3.749334862385321], ['002901', '大博医疗', 30100], ['002900', '哈三联', 172850], ['002881', '美格智能', 2.470105157736605], ['002868', '绿康生化', 109600], ['002863', '今飞凯达', 187648], ['002847', '盐津铺子', 116000], ['002846', '英联股份', 100000], ['002828', '贝肯能源', 183390], ['002813', '路畅科技', 3.081145584725537], ['002808', '恒久科技', 2.711742263671047], ['002793', '东音股份', 106800], ['002790', '瑞尔特', 81500], ['002777', '久远银海', 4.9436849132176235], ['002774', '快意电梯', 97600], ['002768', '国恩股份', 4.52906976744186], ['002757', '南兴装备', 7.295845070422535], ['002746', '仙坛股份', 3.1055436808067522], ['002742', '三圣股份', 197800], ['002719', '麦趣尔', 121300], ['002711', '欧浦智网', 2.320528706110815], ['002707', '众信旅游', 2.8865450399087798], ['002692', '远程股份', 474602], ['002684', '猛狮科技', 4.533100977198697], ['002683', '宏大爆破', 3.5466466520658515], ['002655', '共达电声', 4.190116462071137], ['002652', '扬子新材', 465300], ['002649', '博彦科技', 6.4066791901481945], ['002646', '青青稞酒', 3.0703666997026757], ['002637', '赞宇科技', 338609], ['002636', '金安国纪', 2.009387430389817], ['002613', '北玻股份', 825030], ['002601', '龙蟒佰利', 7.358335389423472], ['002599', '盛通股份', 192400], ['002586', '围海股份', 5.070628500311138], ['002570', '*ST因美', 4.4697644812221515], ['002567', '唐人神', 3.3496720320453788], ['002556', '辉隆股份', 350200], ['002548', '金新农', 2.127736348328121], ['002546', '新联电子', 5.556179289026275], ['002527', '新时达', 2.148559085133418], ['002524', '光正集团', 455300], ['002521', '齐峰新材', 4.849880478087649], ['002516', '旷达科技', 4.586565992147388], ['002515', '金字火腿', 2.8992837958818263], ['002505', '大康农业', 3.7937108950824756], ['002502', '骅威文化', 4.138538461538461], ['002499', '科林环保', 195500], ['002481', '双塔食品', 4.667966922639567], ['002471', '中超控股', 3.427112935480476], ['002454', '松芝股份', 300000], ['002453', '华软科技', 370000], ['002448', '中原内配', 171850], ['002445', 'ST中南', 2.7382259147364887], ['002433', '太安堂', 394800], ['002425', '凯撒文化', 136200], ['002424', '贵州百灵', 3.47241846226304], ['002411', '延安必康', 2.2727402555460845], ['002401', '中远海科', 2.3208659793814435], ['002392', '北京利尔', 955800], ['002386', '天原集团', 2.1061001754044044], ['002374', '丽鹏股份', 1815800], ['002361', '神剑股份', 2.753430924062214], ['002357', '富临运业', 5.0028], ['002351', '漫步者', 684800], ['002345', '潮宏基', 2.093218514531755], ['002329', '皇氏集团', 573800], ['002319', '乐通股份', 3.4782903981264637], ['002316', '亚联发展', 226000], ['002309', '中利集团', 2.4247072860533114], ['002303', '美盈森', 1127788], ['002298', '中电兴发', 295100], ['002291', '星期六', 386300], ['002290', '中科新材', 212100], ['002284', '亚太股份', 402800], ['002283', '天润曲轴', 2.012149444063867], ['002282', '博深工具', 102400], ['002268', '卫 士 通', 2.240524672453202], ['002267', '陕天然气', 1174340], ['002264', '新 华 都', 5.071024655055417], ['002263', '*ST东南', 4.262344486862789], ['002255', '海陆重工', 2.839076107535025], ['002203', '海亮股份', 4.1595437053326005], ['002198', '嘉应制药', 452000], ['002177', '御银股份', 3.3571068329718003], ['002164', '宁波东力', 4.675596551032685], ['002154', '报 喜 鸟', 710600], ['002144', '宏达高科', 191648], ['002136', '安 纳 达', 3.5536480686695278], ['002130', '沃尔核材', 2.3443888088972744], ['002122', '*ST天马', 696000], ['002119', '康强电子', 143420], ['002117', '东港股份', 2.5050665399239542], ['002102', 'ST冠福', 6.2537735420921265], ['002096', '南岭民爆', 356419], ['002094', '青岛金王', 6.69862509391435], ['002069', '獐子岛', 485900], ['002061', '浙江交科', 3.4556982274102896], ['002047', '宝鹰股份', 2.6641233952864534], ['002037', '久联发展', 109300], ['002021', '中捷资源', 2.241811666193585], ['001872', '招商港口', 312500], ['000996', '中国中期', 2.435527524245892], ['000982', '*ST 中绒', 4789000], ['000939', '*ST凯迪', 15008200], ['000937', '冀中能源', 5.689243636363637], ['000923', '河北宣工', 2.7251027397260272], ['000922', '佳电股份', 2.9725960644561513], ['000909', '数源科技', 128402], ['000905', '厦门港务', 2.3305367829590926], ['000888', '峨眉山Ａ', 3.3506666666666667], ['000883', '湖北能源', 2.0685172263477556], ['000881', '中广核技', 1585731], ['000848', '承德露露', 2.1650230551836978], ['000822', '山东海化', 2.4388997078870496], ['000820', '神雾节能', 2.579946884576098], ['000816', '*ST慧业', 6.826373944232326], ['000809', '铁岭新城', 770000], ['000795', '英洛华', 2.6836557390167783], ['000790', '泰合健康', 2.6499588765687827], ['000788', '北大医药', 181200], ['000760', '斯太尔', 2.8045225446124507], ['000755', '山西路桥', 824200], ['000733', '振华科技', 4.388689740420272], ['000712', '锦龙股份', 2.532301696585141], ['000707', '*ST双环', 5.363988579338986], ['000685', '中山公用', 3.3232758118860066], ['000667', '美好置业', 352200], ['000638', '万方发展', 165900], ['000637', '茂化实华', 493500], ['000632', '三木集团', 570400], ['000628', '高新发展', 102200], ['000617', '中油资本', 180000], ['000613', '大东海A', 3.432452276064611], ['000603', '盛达矿业', 2.2223788546255507], ['000599', '青岛双星', 458800], ['000598', '兴蓉环境', 5.082216588192684], ['000593', '大通燃气', 3.6356969696969696], ['000587', '金洲慈航', 3.4142195998337006], ['000585', '*ST东电', 2.145646231940648], ['000573', '粤宏远Ａ', 612300], ['000561', '烽火电子', 3.4967284623773174], ['000560', '我爱我家', 437800], ['000555', '神州信息', 2.391834316139005], ['000552', '靖远煤电', 3.0774036976919117], ['000550', '江铃汽车', 6.802302771855011], ['000548', '湖南投资', 543100], ['000544', '中原环保', 179250], ['000541', '佛山照明', 2.5689322765247726], ['000530', '大冷股份', 7.981474164133739], ['000526', '紫光学大', 120700], ['000520', '长航凤凰', 7.441656598513011], ['000505', '京粮控股', 436500], ['000301', '东方盛虹', 2.822982534043813], ['000158', '常山北明', 2.511312294659121], ['000153', '丰原药业', 669000], ['000150', '宜华健康', 2.5106469276008925], ['000088', '盐 田 港', 3.5017370931424963], ['000058', '深 赛 格', 2.9085907202216066], ['000045', '深纺织Ａ', 2.359114139693356], ['000038', '深大通', 2.1581699346405228], ['000025', '特 力Ａ', 2.1453831719755487], ['601558', 'ST锐电', 2.0747790180011614], ['600871', '*ST油服', 9.102129337539433], ['600722', '金牛化工', 4.923615874571289], ['600715', '文投控股', 6.051069729509311], ['600321', '*ST正源', 3.3490420088063786], ['600289', '*ST信通', 902000]]
    print(date_list_neat)
    up_list_1 = []
    up_list_2 = []
    up_list_3 = []
    up_list_4 = []
    num1 = 0
    num2 = 0
    num3 = 0
    num4 = 0
    for i in date_list_neat:
        print(i)
        proportion = 0
        up_stock = ts.get_realtime_quotes(i[0])
        # up_stock = ts.get_hist_data(i[0], start='2019-03-07', end='2019-03-07')
        print(up_stock)
        # print(up_stock['price'][0])
        # print(up_stock['pre_close'][0])
        proportion = float(up_stock['price'][0]) / float(up_stock['pre_close'][0])
        if(proportion < 1):
            up_list_1.append(up_stock)
            num1 = num1 + 1
        elif(proportion >=0 and proportion < 1.02):
            up_list_2.append(up_stock)
            num2 = num2 + 1
        elif (proportion >= 1.02 and proportion < 1.05):
            up_list_3.append(up_stock)
            num3 = num3 + 1
        elif (proportion >= 1.05):
            up_list_4.append(up_stock)
            num4 = num4 + 1
    print('昨天流入资金多的' + str(len(date_list_neat)) + '支股票有' + str(num1) + '支下跌')
    # print(up_list_1)
    print('有' + str(num2) + '支上涨20%以内')
    print(up_list_2)
    print('有' + str(num3) + '支上涨50%以内')
    print(up_list_3)
    print('有' + str(num4) + '支上涨50%以上')
    print(up_list_4)

get_today_block_transaction_stock()

# if ('ST' in '*ST双环'):
#     print('1111')


# up_stock = ts.get_hist_data('603977', start='2019-03-07', end='2019-03-07')
# print(up_stock['ma5'][0], up_stock['ma10'][0], up_stock['ma20'][0])